<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infographic Lịch TTHC Công an phường Buôn Hồ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div class="max-w-6xl mx-auto bg-white shadow-lg rounded-lg overflow-hidden p-4 md:p-8">
        <!-- Nội dung infographic tĩnh -->
        <div class="mb-8 md:mb-10 bg-blue-50 p-6 rounded-lg shadow-lg border border-blue-200">
            <h2 class="text-xl md:text-2xl lg:text-3xl font-bold text-blue-800 mb-3 md:mb-4 text-center">
                Thông báo về lịch tiếp nhận và giải quyết TTHC tại Công an phường Buôn Hồ
            </h2>
            <p class="text-base md:text-lg text-gray-700 mb-4 text-center">
                Nhằm tạo điều kiện thuận lợi cho người dân, Công an phường Buôn Hồ thông báo lịch tiếp nhận, giải quyết thủ tục hành chính (TTHC) như sau:
            </p>
            
            <h3 class="text-lg md:text-xl font-semibold text-blue-700 mt-4 mb-2">
                1. Thời gian và địa điểm làm việc
            </h3>
            <ul class="list-disc list-inside space-y-2 text-gray-800 text-sm md:text-base">
                <li>
                    <span class="font-bold">Thời gian:</span> Công an phường tiếp nhận và giải quyết TTHC từ <span class="font-bold">thứ Hai đến thứ Sáu</span>. Riêng đối với lĩnh vực Cấp đổi, cấp lại giấy phép lái xe, thời gian tiếp nhận kéo dài đến sáng <span class="font-bold">thứ Bảy</span>.
                </li>
                <li>
                    <span class="font-bold">Thời gian làm việc trong ngày:</span>
                    <ul class="list-none ml-6 space-y-1">
                        <li>Sáng: Từ 07h00 đến 11h30. (<span class="text-gray-500 italic">Thời gian từ 11h00 đến 11h30 dành cho công tác xử lý hồ sơ</span>)</li>
                        <li>Chiều: Từ 13h30 đến 17h00. (<span class="text-gray-500 italic">Thời gian từ 16h30 đến 17h00 dành cho công tác xử lý hồ sơ</span>)</li>
                    </ul>
                </li>
                <li>
                    <span class="font-bold">Địa điểm:</span> Công an phường Buôn Hồ, số 04 Trần Hưng Đạo, phường Buôn Hồ, Đắk Lắk.
                </li>
                <li>
                    <span class="font-bold">Số điện thoại liên hệ:</span> 0262.387.2299.
                </li>
            </ul>

            <h3 class="text-lg md:text-xl font-semibold text-blue-700 mt-4 mb-2">
                2. Lịch ưu tiên tiếp nhận theo từng lĩnh vực
            </h3>
            <ul class="list-disc list-inside space-y-2 text-gray-800 text-sm md:text-base">
                <li>
                    <span class="font-bold">Định danh và xác thực điện tử:</span> Tiếp nhận vào <span class="font-bold">sáng thứ Hai</span>. 
                </li>
                <li>
                    <span class="font-bold">Cấp, quản lý căn cước:</span> Tiếp nhận vào <span class="font-bold">chiều thứ Hai, cả ngày thứ Ba và thứ Tư</span>.
                </li>
                <li>
                    <span class="font-bold">Cư trú:</span> Tiếp nhận vào <span class="font-bold">thứ Hai, thứ Ba, thứ Tư</span>.
                </li>
                <li>
                    <span class="font-bold">Đăng ký, quản lý phương tiện giao thông:</span> Tiếp nhận từ <span class="font-bold">thứ Hai đến thứ Sáu</span>.
                </li>
                <li>
                    <span class="font-bold">Cấp đổi, cấp lại giấy phép lái xe (GPLX):</span> Tiếp nhận từ <span class="font-bold">thứ Hai đến sáng thứ Bảy</span>.
                </li>
            </ul>

            <p class="text-sm md:text-base text-gray-600 mt-4 text-center italic">
                Công an phường Buôn Hồ mong bà con nhân dân phối hợp, sắp xếp thời gian hợp lý để việc tiếp nhận và giải quyết TTHC được diễn ra thuận lợi, nhanh chóng và đúng quy định.
            </p>
        </div>
        
        <!-- Trợ lý tra cứu thủ tục hành chính -->
        <div class="mt-8 md:mt-10 bg-yellow-50 p-4 md:p-6 rounded-lg shadow-lg border border-yellow-200">
            <h2 class="text-xl md:text-2xl lg:text-3xl font-bold text-yellow-800 mb-3 md:mb-4 text-center">
                ✨ Trợ lý tra cứu thủ tục hành chính ✨
            </h2>
            <p class="text-base md:text-lg text-gray-700 mb-3 md:mb-4 text-center">
                Nhập câu hỏi của bạn về các thủ tục hành chính để nhận được thông tin hữu ích.
            </p>
            <div class="flex flex-col md:flex-row gap-3 md:gap-4 mb-3 md:mb-4">
                <input type="text" id="procedureQuery" placeholder="Ví dụ: Làm căn cước mất bao lâu?"
                    class="flex-grow p-2 border border-yellow-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 text-sm md:text-base">
                <button id="lookupButton"
                    class="bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 text-sm md:text-base">
                    Tra cứu
                </button>
            </div>
            <div id="loadingIndicator" class="text-center text-yellow-700 text-sm md:text-base hidden">
                Đang tải...
            </div>
            <div id="llmResponse"
                class="mt-3 md:mt-4 p-3 bg-yellow-100 rounded-lg border border-yellow-300 text-gray-800 text-base md:text-lg min-h-[70px] flex items-center justify-center text-center">
                Kết quả tra cứu sẽ hiển thị ở đây.
            </div>
        </div>
    </div>

    <script>
        // Ngữ cảnh cho trợ lý AI
        const infographicContext = `Bạn là trợ lý AI hỗ trợ tra cứu thủ tục hành chính tại Công an phường Buôn Hồ. Dưới đây là lịch làm việc và các lĩnh vực:

1. Thời gian làm việc:
- Thứ Hai đến Thứ Sáu (Cấp đổi/cấp lại GPLX: đến sáng Thứ Bảy)
- Sáng: 07h00 - 11h30 (11h00 - 11h30 xử lý hồ sơ)
- Chiều: 13h30 - 17h00 (16h30 - 17h00 xử lý hồ sơ)

2. Lĩnh vực ưu tiên:
- Định danh điện tử: sáng Thứ Hai
- Căn cước: chiều Thứ Hai, cả ngày Thứ Ba và Thứ Tư
- Cư trú: Thứ Hai, Ba, Tư
- Phương tiện giao thông: Thứ Hai - Thứ Sáu
- GPLX: Thứ Hai - sáng Thứ Bảy`;

        document.addEventListener('DOMContentLoaded', () => {
            const lookupButton = document.getElementById('lookupButton');
            const procedureQueryInput = document.getElementById('procedureQuery');
            const llmResponseDiv = document.getElementById('llmResponse');
            const loadingIndicator = document.getElementById('loadingIndicator');

            // Hàm xử lý khi người dùng nhấn nút tra cứu
            const handleLookup = async () => {
                const userQuery = procedureQueryInput.value.trim();
                if (!userQuery) {
                    llmResponseDiv.textContent = 'Vui lòng nhập câu hỏi của bạn.';
                    return;
                }

                // Hiển thị trạng thái đang tải
                loadingIndicator.classList.remove('hidden');
                llmResponseDiv.textContent = '';

                try {
                    // Tạo prompt từ ngữ cảnh và câu hỏi của người dùng
                    const prompt = `${infographicContext}\n\nCâu hỏi của người dùng: ${userQuery}`;
                    const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                    const payload = { contents: chatHistory };
                    const apiKey = ""; // API key sẽ được tự động cung cấp bởi môi trường
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                    // Lặp lại với thời gian trễ tăng dần để xử lý lỗi mạng tạm thời
                    let response;
                    let retries = 0;
                    const maxRetries = 5;
                    while (retries < maxRetries) {
                        try {
                            response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });
                            if (response.ok) break; // Thoát vòng lặp nếu thành công
                        } catch (error) {
                            console.error(`Lỗi khi fetch (thử lại lần ${retries + 1}):`, error);
                        }
                        retries++;
                        await new Promise(resolve => setTimeout(resolve, Math.pow(2, retries) * 1000)); // Tăng thời gian chờ
                    }

                    if (!response || !response.ok) {
                        throw new Error("Không thể kết nối đến API sau nhiều lần thử.");
                    }

                    const result = await response.json();
                    
                    // Lấy nội dung trả lời từ API
                    const responseText = result?.candidates?.[0]?.content?.parts?.[0]?.text;
                    
                    if (responseText) {
                        llmResponseDiv.textContent = responseText;
                    } else {
                        llmResponseDiv.textContent = 'Không thể lấy được thông tin. Vui lòng thử lại sau.';
                    }
                } catch (err) {
                    console.error('Đã xảy ra lỗi:', err);
                    llmResponseDiv.textContent = 'Đã xảy ra lỗi. Vui lòng thử lại sau.';
                } finally {
                    loadingIndicator.classList.add('hidden');
                }
            };

            // Gán sự kiện cho nút và ô input
            lookupButton.addEventListener('click', handleLookup);
            procedureQueryInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleLookup();
                }
            });
        });
    </script>
</body>
</html>
